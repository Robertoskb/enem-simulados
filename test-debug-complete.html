<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Debug Standalone</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }

        .year-btn {
            padding: 10px 15px;
            margin: 5px;
            border: 1px solid #007bff;
            background: white;
            cursor: pointer;
        }

        .year-btn:hover {
            background: #007bff;
            color: white;
        }

        #year-selection {
            margin: 20px 0;
        }

        .debug {
            background: #f0f0f0;
            padding: 10px;
            margin: 10px 0;
        }
    </style>
</head>

<body>
    <h1>üîç Debug Standalone - Carregamento de Anos</h1>

    <div class="debug">
        <strong>Status:</strong> <span id="status">Aguardando...</span>
    </div>

    <div class="debug">
        <strong>Console Logs:</strong>
        <div id="logs"></div>
    </div>

    <h2>Elemento year-selection:</h2>
    <div id="year-selection" style="border: 2px solid red; min-height: 50px; padding: 10px;">
        (Aguardando carregamento dos anos...)
    </div>

    <h2>Controles:</h2>
    <button onclick="testDataLoader()">Testar DataLoader</button>
    <button onclick="testSimuladoApp()">Testar SimuladoApp</button>
    <button onclick="testUIController()">Testar UIController</button>

    <script type="module">
        // Importar m√≥dulos necess√°rios
        import { DataLoader } from './assets/js/simulado/DataLoader.js';
        import { SimuladoApp } from './assets/js/simulado/SimuladoApp.js';
        import { UIController } from './assets/js/simulado/UIController.js';

        function log(message) {
            console.log(message);
            const logsDiv = document.getElementById('logs');
            logsDiv.innerHTML += `<div>${new Date().toLocaleTimeString()}: ${message}</div>`;
        }

        function updateStatus(status) {
            document.getElementById('status').textContent = status;
            log(`Status: ${status}`);
        }

        // Tornar fun√ß√µes globais para os bot√µes
        window.testDataLoader = async function () {
            updateStatus("Testando DataLoader...");
            try {
                const dataLoader = new DataLoader();
                const data = await dataLoader.loadAllData();
                log(`‚úÖ DataLoader OK - Anos: ${Object.keys(data.positions).join(', ')}`);
                updateStatus("DataLoader funcionando!");
                return data;
            } catch (error) {
                log(`‚ùå DataLoader falhou: ${error.message}`);
                updateStatus("DataLoader falhou!");
            }
        };

        window.testSimuladoApp = async function () {
            updateStatus("Testando SimuladoApp...");
            try {
                // Criar nova inst√¢ncia do app
                window.testApp = new SimuladoApp();
                log("‚úÖ SimuladoApp criado");

                // Aguardar um pouco para a inicializa√ß√£o
                setTimeout(() => {
                    const positions = window.testApp.getPositions();
                    log(`üìä Positions no app: ${Object.keys(positions).join(', ')}`);
                    updateStatus("SimuladoApp funcionando!");
                }, 2000);

            } catch (error) {
                log(`‚ùå SimuladoApp falhou: ${error.message}`);
                updateStatus("SimuladoApp falhou!");
            }
        };

        window.testUIController = function () {
            updateStatus("Testando UIController...");
            try {
                if (!window.testApp) {
                    log("‚ùå Precisa testar SimuladoApp primeiro");
                    return;
                }

                // Testar loadYearButtons diretamente
                const uiController = window.testApp.uiController;
                uiController.loadYearButtons();
                log("‚úÖ UIController.loadYearButtons() executado");
                updateStatus("UIController testado!");

            } catch (error) {
                log(`‚ùå UIController falhou: ${error.message}`);
                updateStatus("UIController falhou!");
            }
        };

        // Auto-execu√ß√£o
        updateStatus("P√°gina carregada");
        log("üöÄ Debug page loaded");

        // Testar automaticamente ap√≥s 1 segundo
        setTimeout(() => {
            log("üîÑ Iniciando teste autom√°tico...");
            testDataLoader().then(() => {
                setTimeout(testSimuladoApp, 1000);
            });
        }, 1000);
    </script>
</body>

</html>